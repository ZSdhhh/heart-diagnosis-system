{"ast":null,"code":"import { reactive, ref, toRefs } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { useStore } from 'vuex';\nimport { ElMessage } from 'element-plus';\nimport { login } from '@/api/user';\nexport default {\n  name: 'Login',\n  setup() {\n    const router = useRouter();\n    const store = useStore();\n    const loginFormRef = ref(null);\n    const state = reactive({\n      loginForm: {\n        username: '',\n        password: ''\n      },\n      loginRules: {\n        username: [{\n          required: true,\n          trigger: 'blur',\n          message: '请输入用户名'\n        }],\n        password: [{\n          required: true,\n          trigger: 'blur',\n          message: '请输入密码'\n        }]\n      },\n      loading: false\n    });\n    const handleLogin = () => {\n      if (!loginFormRef.value) {\n        ElMessage.error('表单引用错误');\n        return;\n      }\n      loginFormRef.value.validate(valid => {\n        if (valid) {\n          state.loading = true;\n          // 简化登录逻辑，不使用MD5加密\n          const loginData = {\n            username: state.loginForm.username,\n            password: state.loginForm.password\n          };\n          login(loginData).then(res => {\n            store.dispatch('login', res.data);\n            ElMessage.success('登录成功');\n            router.push('/home');\n          }).catch(error => {\n            ElMessage.error(error.message || '登录失败');\n          }).finally(() => {\n            state.loading = false;\n          });\n        }\n      });\n    };\n    return {\n      loginFormRef,\n      ...toRefs(state),\n      handleLogin\n    };\n  }\n};","map":{"version":3,"names":["reactive","ref","toRefs","useRouter","useStore","ElMessage","login","name","setup","router","store","loginFormRef","state","loginForm","username","password","loginRules","required","trigger","message","loading","handleLogin","value","error","validate","valid","loginData","then","res","dispatch","data","success","push","catch","finally"],"sources":["/Users/liuxingliang/Desktop/wendang/20240415/heart-diagnosis-system/frontend/src/views/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <div class=\"login-box\">\n      <div class=\"title\">心脏病辅助诊断系统</div>\n      <el-form ref=\"loginFormRef\" :model=\"loginForm\" :rules=\"loginRules\" label-width=\"0\">\n        <el-form-item prop=\"username\">\n          <el-input v-model=\"loginForm.username\" prefix-icon=\"User\" placeholder=\"用户名\"></el-input>\n        </el-form-item>\n        <el-form-item prop=\"password\">\n          <el-input v-model=\"loginForm.password\" prefix-icon=\"Lock\" type=\"password\" placeholder=\"密码\" show-password></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" :loading=\"loading\" class=\"login-button\" @click=\"handleLogin\">登录</el-button>\n        </el-form-item>\n        <div class=\"options\">\n          <router-link class=\"register-link\" to=\"/register\">注册账号</router-link>\n        </div>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, ref, toRefs } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useStore } from 'vuex'\nimport { ElMessage } from 'element-plus'\nimport { login } from '@/api/user'\n\nexport default {\n  name: 'Login',\n  setup() {\n    const router = useRouter()\n    const store = useStore()\n    const loginFormRef = ref(null)\n    \n    const state = reactive({\n      loginForm: {\n        username: '',\n        password: ''\n      },\n      loginRules: {\n        username: [{ required: true, trigger: 'blur', message: '请输入用户名' }],\n        password: [{ required: true, trigger: 'blur', message: '请输入密码' }]\n      },\n      loading: false\n    })\n    \n    const handleLogin = () => {\n      if (!loginFormRef.value) {\n        ElMessage.error('表单引用错误');\n        return;\n      }\n      \n      loginFormRef.value.validate(valid => {\n        if (valid) {\n          state.loading = true\n          // 简化登录逻辑，不使用MD5加密\n          const loginData = {\n            username: state.loginForm.username,\n            password: state.loginForm.password\n          }\n          \n          login(loginData).then(res => {\n            store.dispatch('login', res.data)\n            ElMessage.success('登录成功')\n            router.push('/home')\n          }).catch(error => {\n            ElMessage.error(error.message || '登录失败')\n          }).finally(() => {\n            state.loading = false\n          })\n        }\n      })\n    }\n    \n    return {\n      loginFormRef,\n      ...toRefs(state),\n      handleLogin\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100vh;\n  background-color: #f5f5f5;\n}\n\n.login-box {\n  width: 350px;\n  padding: 30px;\n  background-color: #fff;\n  border-radius: 5px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n\n.title {\n  font-size: 24px;\n  font-weight: bold;\n  margin-bottom: 30px;\n  text-align: center;\n  color: #409EFF;\n}\n\n.login-button {\n  width: 100%;\n}\n\n.options {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 10px;\n}\n\n.register-link {\n  color: #409EFF;\n  text-decoration: none;\n  font-size: 14px;\n}\n</style> "],"mappings":"AAuBA,SAASA,QAAQ,EAAEC,GAAG,EAAEC,MAAK,QAAS,KAAI;AAC1C,SAASC,SAAQ,QAAS,YAAW;AACrC,SAASC,QAAO,QAAS,MAAK;AAC9B,SAASC,SAAQ,QAAS,cAAa;AACvC,SAASC,KAAI,QAAS,YAAW;AAEjC,eAAe;EACbC,IAAI,EAAE,OAAO;EACbC,KAAKA,CAAA,EAAG;IACN,MAAMC,MAAK,GAAIN,SAAS,CAAC;IACzB,MAAMO,KAAI,GAAIN,QAAQ,CAAC;IACvB,MAAMO,YAAW,GAAIV,GAAG,CAAC,IAAI;IAE7B,MAAMW,KAAI,GAAIZ,QAAQ,CAAC;MACrBa,SAAS,EAAE;QACTC,QAAQ,EAAE,EAAE;QACZC,QAAQ,EAAE;MACZ,CAAC;MACDC,UAAU,EAAE;QACVF,QAAQ,EAAE,CAAC;UAAEG,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,MAAM;UAAEC,OAAO,EAAE;QAAS,CAAC,CAAC;QAClEJ,QAAQ,EAAE,CAAC;UAAEE,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,MAAM;UAAEC,OAAO,EAAE;QAAQ,CAAC;MAClE,CAAC;MACDC,OAAO,EAAE;IACX,CAAC;IAED,MAAMC,WAAU,GAAIA,CAAA,KAAM;MACxB,IAAI,CAACV,YAAY,CAACW,KAAK,EAAE;QACvBjB,SAAS,CAACkB,KAAK,CAAC,QAAQ,CAAC;QACzB;MACF;MAEAZ,YAAY,CAACW,KAAK,CAACE,QAAQ,CAACC,KAAI,IAAK;QACnC,IAAIA,KAAK,EAAE;UACTb,KAAK,CAACQ,OAAM,GAAI,IAAG;UACnB;UACA,MAAMM,SAAQ,GAAI;YAChBZ,QAAQ,EAAEF,KAAK,CAACC,SAAS,CAACC,QAAQ;YAClCC,QAAQ,EAAEH,KAAK,CAACC,SAAS,CAACE;UAC5B;UAEAT,KAAK,CAACoB,SAAS,CAAC,CAACC,IAAI,CAACC,GAAE,IAAK;YAC3BlB,KAAK,CAACmB,QAAQ,CAAC,OAAO,EAAED,GAAG,CAACE,IAAI;YAChCzB,SAAS,CAAC0B,OAAO,CAAC,MAAM;YACxBtB,MAAM,CAACuB,IAAI,CAAC,OAAO;UACrB,CAAC,CAAC,CAACC,KAAK,CAACV,KAAI,IAAK;YAChBlB,SAAS,CAACkB,KAAK,CAACA,KAAK,CAACJ,OAAM,IAAK,MAAM;UACzC,CAAC,CAAC,CAACe,OAAO,CAAC,MAAM;YACftB,KAAK,CAACQ,OAAM,GAAI,KAAI;UACtB,CAAC;QACH;MACF,CAAC;IACH;IAEA,OAAO;MACLT,YAAY;MACZ,GAAGT,MAAM,CAACU,KAAK,CAAC;MAChBS;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}