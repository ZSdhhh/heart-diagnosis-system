{"ast":null,"code":"import { reactive, ref, toRefs } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { ElMessage } from 'element-plus';\nimport { register } from '@/api/user';\nimport md5 from 'md5';\nexport default {\n  name: 'Register',\n  setup() {\n    const router = useRouter();\n    const registerForm = ref(null);\n    const validateConfirmPassword = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码'));\n      } else if (value !== state.registerForm.password) {\n        callback(new Error('两次输入密码不一致'));\n      } else {\n        callback();\n      }\n    };\n    const state = reactive({\n      registerForm: {\n        username: '',\n        password: '',\n        confirmPassword: ''\n      },\n      registerRules: {\n        username: [{\n          required: true,\n          trigger: 'blur',\n          message: '请输入用户名'\n        }, {\n          min: 3,\n          max: 20,\n          message: '长度在 3 到 20 个字符',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          trigger: 'blur',\n          message: '请输入密码'\n        }, {\n          min: 6,\n          max: 20,\n          message: '长度在 6 到 20 个字符',\n          trigger: 'blur'\n        }],\n        confirmPassword: [{\n          required: true,\n          trigger: 'blur',\n          message: '请确认密码'\n        }, {\n          validator: validateConfirmPassword,\n          trigger: 'blur'\n        }]\n      },\n      loading: false\n    });\n    const handleRegister = () => {\n      registerForm.value.validate(valid => {\n        if (valid) {\n          state.loading = true;\n          // 密码MD5加密\n          const registerData = {\n            username: state.registerForm.username,\n            password: md5(state.registerForm.password),\n            role: 'user'\n          };\n          register(registerData).then(res => {\n            ElMessage.success('注册成功');\n            router.push('/login');\n          }).catch(error => {\n            ElMessage.error(error.message || '注册失败');\n          }).finally(() => {\n            state.loading = false;\n          });\n        }\n      });\n    };\n    return {\n      registerForm,\n      ...toRefs(state),\n      handleRegister\n    };\n  }\n};","map":{"version":3,"names":["reactive","ref","toRefs","useRouter","ElMessage","register","md5","name","setup","router","registerForm","validateConfirmPassword","rule","value","callback","Error","state","password","username","confirmPassword","registerRules","required","trigger","message","min","max","validator","loading","handleRegister","validate","valid","registerData","role","then","res","success","push","catch","error","finally"],"sources":["/Users/liuxingliang/Desktop/wendang/20240415/heart-diagnosis-system/frontend/src/views/Register.vue"],"sourcesContent":["<template>\n  <div class=\"register-container\">\n    <div class=\"register-box\">\n      <div class=\"title\">注册账号</div>\n      <el-form ref=\"registerForm\" :model=\"registerForm\" :rules=\"registerRules\" label-width=\"0\">\n        <el-form-item prop=\"username\">\n          <el-input v-model=\"registerForm.username\" prefix-icon=\"User\" placeholder=\"用户名\"></el-input>\n        </el-form-item>\n        <el-form-item prop=\"password\">\n          <el-input v-model=\"registerForm.password\" prefix-icon=\"Lock\" type=\"password\" placeholder=\"密码\" show-password></el-input>\n        </el-form-item>\n        <el-form-item prop=\"confirmPassword\">\n          <el-input v-model=\"registerForm.confirmPassword\" prefix-icon=\"Lock\" type=\"password\" placeholder=\"确认密码\" show-password></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" :loading=\"loading\" class=\"register-button\" @click=\"handleRegister\">注册</el-button>\n        </el-form-item>\n        <div class=\"options\">\n          <router-link class=\"login-link\" to=\"/login\">已有账号？去登录</router-link>\n        </div>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, ref, toRefs } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { ElMessage } from 'element-plus'\nimport { register } from '@/api/user'\nimport md5 from 'md5'\n\nexport default {\n  name: 'Register',\n  setup() {\n    const router = useRouter()\n    const registerForm = ref(null)\n    \n    const validateConfirmPassword = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码'))\n      } else if (value !== state.registerForm.password) {\n        callback(new Error('两次输入密码不一致'))\n      } else {\n        callback()\n      }\n    }\n    \n    const state = reactive({\n      registerForm: {\n        username: '',\n        password: '',\n        confirmPassword: ''\n      },\n      registerRules: {\n        username: [\n          { required: true, trigger: 'blur', message: '请输入用户名' },\n          { min: 3, max: 20, message: '长度在 3 到 20 个字符', trigger: 'blur' }\n        ],\n        password: [\n          { required: true, trigger: 'blur', message: '请输入密码' },\n          { min: 6, max: 20, message: '长度在 6 到 20 个字符', trigger: 'blur' }\n        ],\n        confirmPassword: [\n          { required: true, trigger: 'blur', message: '请确认密码' },\n          { validator: validateConfirmPassword, trigger: 'blur' }\n        ]\n      },\n      loading: false\n    })\n    \n    const handleRegister = () => {\n      registerForm.value.validate(valid => {\n        if (valid) {\n          state.loading = true\n          // 密码MD5加密\n          const registerData = {\n            username: state.registerForm.username,\n            password: md5(state.registerForm.password),\n            role: 'user'\n          }\n          \n          register(registerData).then(res => {\n            ElMessage.success('注册成功')\n            router.push('/login')\n          }).catch(error => {\n            ElMessage.error(error.message || '注册失败')\n          }).finally(() => {\n            state.loading = false\n          })\n        }\n      })\n    }\n    \n    return {\n      registerForm,\n      ...toRefs(state),\n      handleRegister\n    }\n  }\n}\n</script>\n\n<style scoped>\n.register-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100vh;\n  background-color: #f5f5f5;\n}\n\n.register-box {\n  width: 350px;\n  padding: 30px;\n  background-color: #fff;\n  border-radius: 5px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n\n.title {\n  font-size: 24px;\n  font-weight: bold;\n  margin-bottom: 30px;\n  text-align: center;\n  color: #409EFF;\n}\n\n.register-button {\n  width: 100%;\n}\n\n.options {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 10px;\n}\n\n.login-link {\n  color: #409EFF;\n  text-decoration: none;\n  font-size: 14px;\n}\n</style>"],"mappings":"AA0BA,SAASA,QAAQ,EAAEC,GAAG,EAAEC,MAAK,QAAS,KAAI;AAC1C,SAASC,SAAQ,QAAS,YAAW;AACrC,SAASC,SAAQ,QAAS,cAAa;AACvC,SAASC,QAAO,QAAS,YAAW;AACpC,OAAOC,GAAE,MAAO,KAAI;AAEpB,eAAe;EACbC,IAAI,EAAE,UAAU;EAChBC,KAAKA,CAAA,EAAG;IACN,MAAMC,MAAK,GAAIN,SAAS,CAAC;IACzB,MAAMO,YAAW,GAAIT,GAAG,CAAC,IAAI;IAE7B,MAAMU,uBAAsB,GAAIA,CAACC,IAAI,EAAEC,KAAK,EAAEC,QAAQ,KAAK;MACzD,IAAID,KAAI,KAAM,EAAE,EAAE;QAChBC,QAAQ,CAAC,IAAIC,KAAK,CAAC,SAAS,CAAC;MAC/B,OAAO,IAAIF,KAAI,KAAMG,KAAK,CAACN,YAAY,CAACO,QAAQ,EAAE;QAChDH,QAAQ,CAAC,IAAIC,KAAK,CAAC,WAAW,CAAC;MACjC,OAAO;QACLD,QAAQ,CAAC;MACX;IACF;IAEA,MAAME,KAAI,GAAIhB,QAAQ,CAAC;MACrBU,YAAY,EAAE;QACZQ,QAAQ,EAAE,EAAE;QACZD,QAAQ,EAAE,EAAE;QACZE,eAAe,EAAE;MACnB,CAAC;MACDC,aAAa,EAAE;QACbF,QAAQ,EAAE,CACR;UAAEG,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,MAAM;UAAEC,OAAO,EAAE;QAAS,CAAC,EACtD;UAAEC,GAAG,EAAE,CAAC;UAAEC,GAAG,EAAE,EAAE;UAAEF,OAAO,EAAE,gBAAgB;UAAED,OAAO,EAAE;QAAO,EAC/D;QACDL,QAAQ,EAAE,CACR;UAAEI,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,MAAM;UAAEC,OAAO,EAAE;QAAQ,CAAC,EACrD;UAAEC,GAAG,EAAE,CAAC;UAAEC,GAAG,EAAE,EAAE;UAAEF,OAAO,EAAE,gBAAgB;UAAED,OAAO,EAAE;QAAO,EAC/D;QACDH,eAAe,EAAE,CACf;UAAEE,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,MAAM;UAAEC,OAAO,EAAE;QAAQ,CAAC,EACrD;UAAEG,SAAS,EAAEf,uBAAuB;UAAEW,OAAO,EAAE;QAAO;MAE1D,CAAC;MACDK,OAAO,EAAE;IACX,CAAC;IAED,MAAMC,cAAa,GAAIA,CAAA,KAAM;MAC3BlB,YAAY,CAACG,KAAK,CAACgB,QAAQ,CAACC,KAAI,IAAK;QACnC,IAAIA,KAAK,EAAE;UACTd,KAAK,CAACW,OAAM,GAAI,IAAG;UACnB;UACA,MAAMI,YAAW,GAAI;YACnBb,QAAQ,EAAEF,KAAK,CAACN,YAAY,CAACQ,QAAQ;YACrCD,QAAQ,EAAEX,GAAG,CAACU,KAAK,CAACN,YAAY,CAACO,QAAQ,CAAC;YAC1Ce,IAAI,EAAE;UACR;UAEA3B,QAAQ,CAAC0B,YAAY,CAAC,CAACE,IAAI,CAACC,GAAE,IAAK;YACjC9B,SAAS,CAAC+B,OAAO,CAAC,MAAM;YACxB1B,MAAM,CAAC2B,IAAI,CAAC,QAAQ;UACtB,CAAC,CAAC,CAACC,KAAK,CAACC,KAAI,IAAK;YAChBlC,SAAS,CAACkC,KAAK,CAACA,KAAK,CAACf,OAAM,IAAK,MAAM;UACzC,CAAC,CAAC,CAACgB,OAAO,CAAC,MAAM;YACfvB,KAAK,CAACW,OAAM,GAAI,KAAI;UACtB,CAAC;QACH;MACF,CAAC;IACH;IAEA,OAAO;MACLjB,YAAY;MACZ,GAAGR,MAAM,CAACc,KAAK,CAAC;MAChBY;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}